<!DOCTYPE html>
<html>
    <head>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            outline: 0;
            background-color: white;
            -ms-overflow-style: none; 
            scrollbar-width: none;
            cursor: crosshair;
        }
        html::-webkit-scrollbar {
            display: none;
        }
        canvas {
            background-color:rgb(255, 255, 255);
        }
        </style>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div>
        <input type="color" value="color" id="color" style="z-index:2; margin-bottom: 5px;" onchange="choose()">
        <input type="number" id="stroke" placeholder="Enter stroke size" style="z-index:2; margin-bottom: 5px;" onchange="choose()">
        <input type="button" style="z-index:2; margin-bottom: 5px;" value="Clear" onclick="clearAll()">
        <!-- <button onclick="myFunction()" style="z-index:2; margin-bottom: 5px;">Switch Theme</button> -->
        <button class="download"><a id="download" download="myImage.jpg" href="" onclick="download_img(this);"></a>Download</button>
        <input type="file" id="imageLoader" name="imageLoader"/>
        <canvas id="canvas""></canvas>
    </div>
    <script type="text/javascript">
        var canvas = document.getElementById("canvas");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        var imageLoader = document.getElementById('imageLoader');
        imageLoader.addEventListener('change', handleImage, false);
        var ctx = canvas.getContext("2d");
        let drawing = false

        //function to change theme
        function myFunction() {     
            if (ctx.fillStyle == "#000000"){
                ctx.fillStyle = "white"
            }else{
                ctx.fillStyle = "black"
            };
            ctx.fillRect(0, 0, canvas.width, canvas.height)
        }

        var mouse = {x: 0, y: 0};
        var last_mouse = {x: 0, y: 0};

        /* Mouse Capturing Work */
        canvas.addEventListener('mousemove', function(e) {
            last_mouse.x = mouse.x;
            last_mouse.y = mouse.y;

            mouse.x = e.pageX - this.offsetLeft;
            mouse.y = e.pageY - this.offsetTop;
        }, false);



        //function to choose color and color
        function choose() {
            var chooseColor = document.getElementById("color").value;
            var chooseStroke = document.getElementById("stroke").value;

            return {
                chooseColor,
                chooseStroke
            };
        }

        //function to clear the canvas
        function clearAll(){
            canvas.width = canvas.width;
        }
        
        function draw(e) {
            if (drawing == false) return;
            // ctx.lineWidth = 10; //default stroke width
            ctx.strokeStyle = "red";	
            let editor = choose();
            ctx.lineWidth = editor.chooseStroke;
            ctx.strokeStyle = editor.chooseColor;	
            ctx.lineCap ="round";
            ctx.lineJoin = 'round';
            ctx.stroke();
            ctx.lineTo(e.clientX, e.clientY);
            ctx.moveTo(e.clientX, e.clientY);
            ctx.beginPath();


            // ctx.lineTo(e.clientX, e.clientY);
            // ctx.moveTo(e.clientX, e.clientY);
            // ctx.stroke();
    
            

        }
        

        function startDraw(e) {
            drawing = true;
            draw(e);
        }

        function overDraw() {
            drawing = false;
            ctx.beginPath();
        }    
    
        download_img = function(el) {
            var image = canvas.toDataURL("image/jpg");
            el.href = image;
        };

        function handleImage(e){
            var reader = new FileReader();
            reader.onload = function(event){
                var img = new Image();
                img.onload = function(){
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img,0,0);
                }
                img.src = event.target.result;
            }
            reader.readAsDataURL(e.target.files[0]);     
        }
        
        canvas.addEventListener('mousedown', function(e) {
            canvas.addEventListener('mousemove', onPaint, false);
        }, false);

        canvas.addEventListener('mouseup', function() {
            canvas.removeEventListener('mousemove', onPaint, false);
        }, false);

        var onPaint = function() {
            ctx.beginPath();
            ctx.moveTo(last_mouse.x, last_mouse.y);
            ctx.lineTo(mouse.x, mouse.y);
            ctx.closePath();
            ctx.stroke();
        };
    
        canvas.addEventListener("mousedown", startDraw);
        canvas.addEventListener("mouseup", overDraw);
        canvas.addEventListener("mousemove", draw);
        
    
    </script> 
</body>
</html